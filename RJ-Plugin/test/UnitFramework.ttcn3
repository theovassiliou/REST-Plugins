module UnitFramework {
	import from Lib_HTTP all;

	const charstring basePath := "/v2";
	modulepar charstring host := "petstore.swagger.io";
	const charstring BASE_URL := "https://" & host & basePath;

	type port HTTPPort message {
		inout all;
		map param (RESTAPIconfig config);
		address EncodedRequest;
	}
	with {
		encode "RESTful"
	}


	type port TS_HTTPPort message {
		inout all;
		map param (RESTAPIconfig config);
	}
	with {
		encode "RESTful"
	}

	type component TSRestService {
		port TS_HTTPPort server;
	}

	type record GETRequest {
	}
	

	type component RESTComponent {
		port HTTPPort service;
	}

	function assertRequestLine(template EncodedRequest want , EncodedRequest got, string logMessage)
		return boolean {
		if (match(got, want)) {
			setverdict(pass);
			return true;
		}
		setverdict(fail, logMessage);
		return false;
	}

	function setUp(TSRestService sys) runs on RESTComponent {
		map(mtc:service, sys:server)
		param (RESTAPIconfig:{baseUrl := BASE_URL,authorization := omit});
		activate(directMatch());
	}



	altstep directMatch() runs on RESTComponent {
	[] service.receive {
			setverdict(fail);
		}
	}
}