module DELETERequestTests {
	import from openapiv3 all;
	import from UnitFramework all;

	type record DELETEFindByStatus {
		record of integer id optional, Pet pet
	}
	with {
		encode "REST/delete";
		variant "path: /pet/findByStatus";
		encode (id) "query";
		encode (pet) "body/json"
	}


	type record Pet {
		string name, string _type, record of string aspects
	}
	with {
		variant (_type) "type"
	}


	template Pet firstPet := {"the Pet 1", "dog", {"brown hair","4 legs"}}

	testcase OneQuery() runs on RESTComponent system TSRestService {
		var HTTPPort.address requestLine;

		setUp(system);
		service.send(DELETEFindByStatus:{{2246},firstPet});
		service.receive(?) -> sender requestLine;
		assertRequestLine(requestLine,
						  string:
						  "DELETE https://petstore.swagger.io/v2/pet/findByStatus?id=2246"
						  , "RequestLine not encoded correctly");
	}
}